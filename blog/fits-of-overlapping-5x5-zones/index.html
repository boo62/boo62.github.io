<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="https://boo62.github.io/blog/fits-of-overlapping-5x5-zones/">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fits of overlapping 5x5 zones | boo62</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://boo62.github.io/blog/fits-of-overlapping-5x5-zones/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Daniel Boocock">
<link rel="prev" href="../writing-models-in-sbml/" title="Writing models in SBML" type="text/html">
<meta property="og:site_name" content="boo62">
<meta property="og:title" content="Fits of overlapping 5x5 zones">
<meta property="og:url" content="https://boo62.github.io/blog/fits-of-overlapping-5x5-zones/">
<meta property="og:description" content="Procedure
I took cell measurement data from plate 15 for overlapping 5x5 zones
with top-left coordinates (7, 13) and (9, 15) where coordinates start
(0, 0). I guessed the initial amount of nutrients f">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-06-15T13:14:58+01:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://boo62.github.io/">

                <span id="blog-title">boo62</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../organizer/">Organizer</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>
                </li>
<li>
<a href="../">Blog</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Fits of overlapping 5x5 zones</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    Daniel Boocock
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2016-06-15T13:14:58+01:00" itemprop="datePublished" title="2016-06-15 13:14">2016-06-15 13:14</time></a></p>
                <p class="commentline">
        


            
        </p>
<p class="sourceline"><a href="index.rst" id="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="section" id="procedure">
<h2>Procedure</h2>
<p>I took cell measurement data from plate 15 for overlapping 5x5 zones
with top-left coordinates (7, 13) and (9, 15) where coordinates start
(0, 0). I guessed the initial amount of nutrients from the average of
final cell amounts just for the zone (i.e not full plate). I used a
10x11x11 grid of guesses for C_0, kn, and r. C_0 guesses are on a
logarithmic scale whereas kn and r guesses are on a linear scale (see
code below). I used the same r guess for all cultures in a single fit.</p>
<p>Code for grid of guesses:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_6ae00196796d49d9b756e0c3655cd7b6-1">1</a>
<a href="#rest_code_6ae00196796d49d9b756e0c3655cd7b6-2">2</a>
<a href="#rest_code_6ae00196796d49d9b756e0c3655cd7b6-3">3</a>
<a href="#rest_code_6ae00196796d49d9b756e0c3655cd7b6-4">4</a>
<a href="#rest_code_6ae00196796d49d9b756e0c3655cd7b6-5">5</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_6ae00196796d49d9b756e0c3655cd7b6-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<a name="rest_code_6ae00196796d49d9b756e0c3655cd7b6-2"></a>
<a name="rest_code_6ae00196796d49d9b756e0c3655cd7b6-3"></a><span class="n">C_0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_6ae00196796d49d9b756e0c3655cd7b6-4"></a><span class="n">kns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<a name="rest_code_6ae00196796d49d9b756e0c3655cd7b6-5"></a><span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
</pre></td>
</tr></table>
<p>I made bounds large in the hope that the best fits would not have any
estimates located at a boundary. I fit the competition model to both
zones using each of the 1000 initial guesses.</p>
</div>
<div class="section" id="results">
<h2>Results</h2>
<p>The table below contains estimates for the two best guesses for each
zone (totalling four for each zone). r_18 and r_6 are estimates of
growth constant for the same culture from different zones. This
culture is the central culture in the red area (representing the
overlap) in the plots at the bottom of the post.</p>
<img alt="../../images/fits-of-overlapping-5x5-zones/est_table.png" src="../../images/fits-of-overlapping-5x5-zones/est_table.png"><p>The two best fits for each zone have reasonable agreement in estimated
parameters. However we are hoping to find a global minimum where the
parameter estimates are, within the limits of accuracy of the
data/minimizer, the same and I am not sure that this is happening.</p>
<p>Agreement of parameter estimates between the two zones is fairly poor.</p>
<p>For zone (7, 13) estimates 440 and 803 produced N_0 guesses at the
lower bounds, highlighted in yellow.</p>
<div class="section" id="the-effect-of-boundaries">
<h3>The Effect of Boundaries</h3>
<p>At the moment I include least squares fits of cell observations for
edge cultures in the objective function. Competition with cultures
outside of the boundary causes a discrepency between the actual
amount of nutrients in edge cultures and the amount of nutrients
predicted by fits of our model. There is also likely to be a net flux
of nutrients between the zone and the rest of the plate so when we
include all of the cultures in the objective function we incorectly
fix the total amount of nutrients in the zone (assuming growth runs
long enough to complete this is equal to the final amount of cells)
and this affects estimates of N_0 and in turn the other parameters. In
fits of zones, a buffer could be created by allowing parameters for
edge cultures to be estimated but without including measurements for
these cultures in the objective function.</p>
<p>In the current fits, I made guesses of N_0 from the zone, from which I
then determined bounds. If there is a buffer at the boundary, N_0 is
not so strongly coupled to the final cell observations and I can
instead use guesses and bounds for the plate rather than zone.</p>
<p>I have increased the speed of simulations significantly by vectorising
ode calculations using numpy (5x for full plate). We also have an even
faster simulation method using RoadRunner with models written in SBML
(50x faster again for a full plate). This should have translated into
a speed up of fitting so we could now also try fitting larger zones
where there is a smaller proportion of edge cultures. I could also fit
two overlapping zones on a simulated plate as verification.</p>
</div>
<div class="section" id="initial-guesses">
<h3>Initial Guesses</h3>
<img alt="../../images/fits-of-overlapping-5x5-zones/guesses.png" src="../../images/fits-of-overlapping-5x5-zones/guesses.png"><p>Interestingly, the best fits all had initial guesses of zero for
kn. Estimates of C_0 were similar for each pair of best fits despite
very different initial guesses. Guesses or r were close or fairly
similar to the mean estimate for the plate.</p>
<p>I am not sure that the full parameter space is being explored by the
fitter. We could do with getting better initial guesses for r and/or using
a genetic algorithm/swarm.</p>
</div>
</div>
<div class="section" id="plots-of-fits">
<h2>Plots of Fits</h2>
<p>Overlapping zones are indicated by red boxes with fits using the same
initial guess displayed side by side.</p>
<div class="section" id="guess-638">
<h3>Guess 638</h3>
<img alt="../../images/fits-of-overlapping-5x5-zones/coords_7_13_5x5_argv_638.png" src="../../images/fits-of-overlapping-5x5-zones/coords_7_13_5x5_argv_638.png" style="width: 49%;"><img alt="../../images/fits-of-overlapping-5x5-zones/coords_9_15_5x5_argv_638.png" src="../../images/fits-of-overlapping-5x5-zones/coords_9_15_5x5_argv_638.png" style="width: 49%;">
</div>
<div class="section" id="guess-1012">
<h3>Guess 1012</h3>
<img alt="../../images/fits-of-overlapping-5x5-zones/coords_7_13_5x5_argv_1012.png" src="../../images/fits-of-overlapping-5x5-zones/coords_7_13_5x5_argv_1012.png" style="width: 49%;"><img alt="../../images/fits-of-overlapping-5x5-zones/coords_9_15_5x5_argv_1012.png" src="../../images/fits-of-overlapping-5x5-zones/coords_9_15_5x5_argv_1012.png" style="width: 49%;">
</div>
<div class="section" id="guess-440">
<h3>Guess 440</h3>
<img alt="../../images/fits-of-overlapping-5x5-zones/coords_7_13_5x5_argv_440.png" src="../../images/fits-of-overlapping-5x5-zones/coords_7_13_5x5_argv_440.png" style="width: 49%;"><img alt="../../images/fits-of-overlapping-5x5-zones/coords_9_15_5x5_argv_440.png" src="../../images/fits-of-overlapping-5x5-zones/coords_9_15_5x5_argv_440.png" style="width: 49%;">
</div>
<div class="section" id="guess-803">
<h3>Guess 803</h3>
<img alt="../../images/fits-of-overlapping-5x5-zones/coords_7_13_5x5_argv_803.png" src="../../images/fits-of-overlapping-5x5-zones/coords_7_13_5x5_argv_803.png" style="width: 49%;"><img alt="../../images/fits-of-overlapping-5x5-zones/coords_9_15_5x5_argv_803.png" src="../../images/fits-of-overlapping-5x5-zones/coords_9_15_5x5_argv_803.png" style="width: 49%;">
</div>
<div class="section" id="discussion">
<h3>Discussion</h3>
<p>Even the worst fits, with parameter guesses at the bounds, are
qualitatively quite close to timecourse data. However, parameters from
the two best fits for each zone are reasonably close so it looks like
we might have enough power to discern between mimima that are far
apart and recover reasonable estimates (i.e. there is not too much
noise in the data). Dealing better with boundaries might improve
agreement between the zones.</p>
<p>How can a Bayesian approach help us deal with local minima that are
far apart compared to a genetic algorithm?</p>
<!-- If we have two (or more) local minima, fairly far appart, that we are4
unable to discern between, would a Bayesian aproach, where we instead
estimate parameter distributions, be the best way to deal with this? -->
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../writing-models-in-sbml/" rel="prev" title="Writing models in SBML">Previous post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        


        </section></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:daniel.boocock@protonmail.ch">Daniel Boocock</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
