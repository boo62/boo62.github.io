<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="https://boo62.github.io/blog/fits-of-overlapping-5x5-zones/">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fits of overlapping 5x5 zones | boo62</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://boo62.github.io/blog/fits-of-overlapping-5x5-zones/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Daniel Boocock">
<link rel="prev" href="../writing-models-in-sbml/" title="Writing models in SBML" type="text/html">
<meta property="og:site_name" content="boo62">
<meta property="og:title" content="Fits of overlapping 5x5 zones">
<meta property="og:url" content="https://boo62.github.io/blog/fits-of-overlapping-5x5-zones/">
<meta property="og:description" content="Procedure
I took cell measurement data from plate 15 for overlapping 5x5 zones
with top-left coordinates (7, 13) and (9, 15) where coordinates start
(0, 0). I guessed the initial amount of nutrients f">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-06-15T13:14:58+01:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://boo62.github.io/">

                <span id="blog-title">boo62</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../organizer/">Organizer</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>
                </li>
<li>
<a href="../">Blog</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Fits of overlapping 5x5 zones</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    Daniel Boocock
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2016-06-15T13:14:58+01:00" itemprop="datePublished" title="2016-06-15 13:14">2016-06-15 13:14</time></a></p>
                <p class="commentline">
        


            
        </p>
<p class="sourceline"><a href="index.rst" id="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="section" id="procedure">
<h2>Procedure</h2>
<p>I took cell measurement data from plate 15 for overlapping 5x5 zones
with top-left coordinates (7, 13) and (9, 15) where coordinates start
(0, 0). I guessed the initial amount of nutrients from the average of final cell
amounts. I used a 10x11x11 grid of guesses for C_0, kn, and r. C_0
guesses were on a logarithmic scale whereas kn and r guesses were ona
linear scale (see code below). I used the same r guess for all
cultures in a single fit.</p>
<p>Code for grid of guesses:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_f31455dddc564ff1a39a9ece5b51ca53-1">1</a>
<a href="#rest_code_f31455dddc564ff1a39a9ece5b51ca53-2">2</a>
<a href="#rest_code_f31455dddc564ff1a39a9ece5b51ca53-3">3</a>
<a href="#rest_code_f31455dddc564ff1a39a9ece5b51ca53-4">4</a>
<a href="#rest_code_f31455dddc564ff1a39a9ece5b51ca53-5">5</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_f31455dddc564ff1a39a9ece5b51ca53-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<a name="rest_code_f31455dddc564ff1a39a9ece5b51ca53-2"></a>
<a name="rest_code_f31455dddc564ff1a39a9ece5b51ca53-3"></a><span class="n">C_0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a name="rest_code_f31455dddc564ff1a39a9ece5b51ca53-4"></a><span class="n">kns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<a name="rest_code_f31455dddc564ff1a39a9ece5b51ca53-5"></a><span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
</pre></td>
</tr></table>
<p>I made bounds large in the hope that solutions would not have any
estimates located at a boundary. I fit the competition model to both
zones using each of the 1000 initial guesses. The table bw</p>
<img alt="../../images/fits-of-overlapping-5x5-zones/est_table.png" src="../../images/fits-of-overlapping-5x5-zones/est_table.png"><p>The two best fits for each zone have reasonable agreement in estimated
parameters. However we are hoping to find a global minimum where the
parameter estimates are, within the limits of accuracy of the
minimizer, the same and it doesn't look like this is happening.</p>
<p>Unfortunately, agreement of parameter estimates between the two zones
is fairly poor.</p>
<p>For zone (7, 13) estimates 440 and 803 produced N_0 guesses at the lower bounds.</p>
<p>I am not sure how much cultures the boundaries could be messing up
fits. At the moment I include least squares fits of cell observations
for edge cultures in the objective function. This will cause issues
for the model because neighbours compete for nutrients and there is a
great uncertainty about the amount of nutrients in edge cultures due
to competition with cultures outside the boundary. There is likely to
be a net flux of nutrients between the zone and the rest of the
plate. When we include all of the cultures in the objective function
we also fix the total amount of nutrients in the zone (assuming growth
runs long enough to complete this is equal to the final amount of
cells) and this affects N_0 (in fact all of the parameters are
coupled). In fits of zones, a buffer could be created by allowing
parameters for edge cultures to be estimated but without including
measurements for these cultures in the objective function.</p>
<p>In the current fits, I made guesses of N_0 from the zone from which I
determined bounds. If there is a buffer at the boundary, N_0 is not so
strongly coupled to the final cell observations and I can instead use
guesses and bounds for the plate rather than zone.</p>
<p>I have increased the speed of simulations significantly by vectorising
ode calculations using numpy (5x for full plate). We also have an even
faster simulation method using RoadRunner with models written in SBML
(50x faster again for a full plate). This should have translated into
a speed up of fitting so we could now also try fitting larger zones
where there is a smaller proportion of edge cultures.</p>
<p>(I could fit a simulated zone to check this. I may have already
done this somewhere.)</p>
</div>
<div class="section" id="plots-of-fits">
<h2>Plots of Fits</h2>
<p>How do the plots look. Why are we haveing truble?</p>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../writing-models-in-sbml/" rel="prev" title="Writing models in SBML">Previous post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        


        </section></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents Â© 2016         <a href="mailto:daniel.boocock@protonmail.ch">Daniel Boocock</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
